(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{407:function(s,a,n){"use strict";n.r(a);var t=n(52),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"livestreaming-pixelfed-live"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#livestreaming-pixelfed-live"}},[s._v("#")]),s._v(" Livestreaming (Pixelfed Live)")]),s._v(" "),n("p",[s._v("Pixelfed Live is a mobile based livestreaming feature.")]),s._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#installing-and-configuring-nginx-rtmp"}},[s._v("Installing and Configuring Nginx-RTMP")])]),n("li",[n("a",{attrs:{href:"#configure-livestreaming-settings"}},[s._v("Configure Livestreaming Settings")]),n("ul",[n("li",[n("a",{attrs:{href:"#basic-configuration"}},[s._v("Basic configuration")])]),n("li",[n("a",{attrs:{href:"#advanced-configuration"}},[s._v("Advanced configuration")])])])])])]),n("p"),s._v(" "),n("h2",{attrs:{id:"installing-and-configuring-nginx-rtmp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#installing-and-configuring-nginx-rtmp"}},[s._v("#")]),s._v(" Installing and Configuring Nginx-RTMP")]),s._v(" "),n("p",[s._v("Begin by running the following commands as a non-root user to update your package listings and install the Nginx module:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" libnginx-mod-rtmp\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("Installing the module won’t automatically start providing a stream. You’ll need to add a configuration block to your Nginx configuration file that defines where and how the stream will be available.")]),s._v(" "),n("p",[s._v("Using nano or your favorite text editor, open Nginx’s main configuration file, /etc/nginx/nginx.conf, and add this configuration block to the end of the file:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/nginx/nginx.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Make sure you edit lines "),n("strong",[s._v("16")]),s._v(", "),n("strong",[s._v("17")]),s._v(" with your domain (leave http:// and the path as is), and line "),n("strong",[s._v("29")]),s._v(" with the path to your "),n("code",[s._v("storage/app/public/live-hls")]),s._v(" directory")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("rtmp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1935")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        chunk_size "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        application live "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            live on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            record off"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            interleave on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            wait_key on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            \n            deny play all"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            push rtmp://127.0.0.1:1935/hls-live "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flashver")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FMLE/3.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            \n            on_publish http://localhost/api/live/broadcast/publish"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            on_publish_done http://localhost/api/live/broadcast/finish"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        application hls-live "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            live on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            hls on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            interleave on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            deny play all"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            allow publish "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            deny publish all"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            hls_path /home/pixelfed/storage/app/public/live-hls"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n            hls_nested on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            hls_fragment 5s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            hls_playlist_length 30s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            hls_fragment_naming system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("p",[s._v("Save and close the file. If you are using "),n("code",[s._v("nano")]),s._v(", press "),n("kbd",[s._v("Ctrl+X")]),s._v(", then when prompted, "),n("kbd",[s._v("Y")]),s._v(" and "),n("kbd",[s._v("Enter")]),s._v(".")]),s._v(" "),n("p",[s._v("This provides the beginning of your RTMP configuration. By default, it listens on port 1935, which means you’ll need to open that port in your firewall. If you configured ufw as part of your initial server setup run the following command.")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ufw allow "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1935")]),s._v("/tcp\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Now you can reload Nginx with your changes:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl reload nginx.service\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("You should now have a working RTMP server. In the next section, we’ll configure the environment settings.")]),s._v(" "),n("h2",{attrs:{id:"configure-livestreaming-settings"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configure-livestreaming-settings"}},[s._v("#")]),s._v(" Configure Livestreaming Settings")]),s._v(" "),n("p",[s._v("Now you have the RTMP server setup, you can proceed to add the following environment variables to your "),n("code",[s._v(".env")]),s._v(" file.")]),s._v(" "),n("h3",{attrs:{id:"basic-configuration"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration"}},[s._v("#")]),s._v(" Basic configuration")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// Enable Pixelfed Live\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n// RTMP server domain\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_HOST")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("pixelfed.social\n\n// Enable livestreaming from the Pixelfed Live app\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_SOURCE_APP")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"advanced-configuration"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#advanced-configuration"}},[s._v("#")]),s._v(" Advanced configuration")]),s._v(" "),n("p",[s._v("In addition to the basic configuration variables, the following variables can be used optionally")]),s._v(" "),n("h4",{attrs:{id:"stream-limits"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#stream-limits"}},[s._v("#")]),s._v(" Stream Limits")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// Max concurrent live streams\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_MAX_ACTIVE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n// Max stream duration "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" minutes\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_MAX_DURATION")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"user-limits"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#user-limits"}},[s._v("#")]),s._v(" User Limits")]),s._v(" "),n("p",[s._v("Advanced control over who can livestream")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("// Enable broadcast limits\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_LIMITS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n// Only allow "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" with over "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" followers to go live\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_LIMITS_MIN_FOLLOWERS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n\n// Only allow "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" with accounts older than "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v(" days to go live\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_LIMITS_MIN_ACCOUNT_AGE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("\n\n// Only allow admin accounts to go live\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HLS_LIVE_BROADCAST_LIMITS_ADMINS_ONLY")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);