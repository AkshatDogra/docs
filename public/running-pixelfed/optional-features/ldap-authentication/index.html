<!DOCTYPE html>
<html lang="en" xml:lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<link rel="stylesheet" href="https://docs.pixelfed.org/css/theme.screen.css" media="screen" />
		<script type="text/javascript" href="https://docs.pixelfed.org/js/script.js"></script>
		
<link rel="shortcut icon" href='https://docs.pixelfed.org/images/icon.png' sizes="765x765">

	

<title>LDAP Authentication | Pixelfed Documentation</title>
<title itemprop="name">LDAP Authentication | Pixelfed Documentation</title>
<meta property="og:title" content="LDAP Authentication | Pixelfed Documentation" />
<meta name="twitter:title" content="LDAP Authentication | Pixelfed Documentation" />
<meta itemprop="name" content="LDAP Authentication | Pixelfed Documentation" />
<meta name="application-name" content="Pixelfed Documentation" />
<meta property="og:site_name" content="Pixelfed Documentation" />
<meta name="description" content="You can configure your Pixelfed server to authenticate with an LDAP Server!">
<meta itemprop="description" content="You can configure your Pixelfed server to authenticate with an LDAP Server!" />
<meta property="og:description" content="You can configure your Pixelfed server to authenticate with an LDAP Server!" />
<meta name="twitter:description" content="You can configure your Pixelfed server to authenticate with an LDAP Server!" />
<base href="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/">
<link rel="canonical" href="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/" itemprop="url" /> 
<meta name="url" content="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/" />
<meta name="twitter:url" content="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/" /> 
<meta property="og:url" content="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/" />

<meta itemprop="image" content='https://docs.pixelfed.org/images/icon.png' />
<meta property="og:image" content='https://docs.pixelfed.org/images/icon.png' />
<meta name="twitter:image" content='https://docs.pixelfed.org/images/icon.png' />
<meta name="twitter:image:src" content='https://docs.pixelfed.org/images/icon.png' />
<meta property="og:updated_time" content=2022-08-07T09:42:43-0500 />
<meta property="og:type" content="website" /> 
<meta name="author" content="" />
<script defer type="application/ld+json">
	{ 
		"@context": "http://schema.org", 
		"@type": "WebSite", 
		"url": "https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/", 
		"name": "LDAP Authentication", 
		"logo": "https://docs.pixelfed.org/images/icon.png"
	}
</script>
<meta property="article:publisher" content="" />


<meta property="og:article:published_time" content=0001-01-01T00:00:00Z /> 
<meta property="article:published_time" content=0001-01-01T00:00:00Z />
<link rel="sitemap" type="application/xml" title="Sitemap" href="https://docs.pixelfed.org/sitemap.xml" /> 

<meta name="robots" content="index,follow" /> 
<meta name="googlebot" content="index,follow" />
<link rel="manifest" href="https://docs.pixelfed.org/manifest.json" />
<meta name="theme-color" content="#ffffff" /> 
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="imagemode" content="force" />
<meta name="coverage" content="Worldwide" /> 
<meta name="distribution" content="Global" />
<meta name="HandheldFriendly" content="True" /> 
<meta name="msapplication-tap-highlight" content="no" />
<meta name="apple-mobile-web-app-title" content="Pixelfed Documentation" /> 
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-touch-fullscreen" content="yes" />
		
		
	</head>
	<body>
		<header class="site-header">
	<div class="container">
		<a href="/" class="site-masthead">
			<img class="site-icon" height="32" src="https://avatars0.githubusercontent.com/u/38410642?s=200&amp;amp;v=4">
			<p class="site-title">Pixelfed Documentation</p>
		</a>
		<nav class="extra-nav">
	<div class="container">
		<ul class="menu">
			
			<li>
				<a href="https://pixelfed.org">
					
					<span>pixelfed.org</span>
					
				 </a>
			</li>
			
			<li>
				<a href="https://github.com/pixelfed/pixelfed">
					
					<span>Github</span>
					
				 </a>
			</li>
			
		</ul>
	</div>
</nav>
	</div>
</header>
<div class="scroll-margin" style="position: relative;">
	<div id="top" style="scroll-margin-top: var(--header-height);"></div>
</div>
<nav class="site-nav section">
	<div class="container">
		<input type="checkbox" class="toggle-menu" name="toggle" id="toggle">
		<label class="toggle-menu__label" for="toggle"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
			<path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7" />
		 </svg> Menu</label>
		<ul class="menu">
			<a id="menu" href="#top">Skip menu</a>
			
			
				
				<li class='section-title'>
				 <a href="https://docs.pixelfed.org/running-pixelfed/">
					
					<span>Run your own Pixelfed website</span>
					
				 </a>
				 <ul class="sub-menu">
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/running-pixelfed/prerequisites/">
								  
								  <span>Preparing your machine</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/running-pixelfed/installation/">
								  
								  <span>Generic installation guide</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/running-pixelfed/administration/">
								  
								  <span>Administering your website</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/running-pixelfed/troubleshooting/">
								  
								  <span>Troubleshooting</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/running-pixelfed/optional-features/">
								  
								  <span>Optional features</span>
								  
								</a>
								<ul class="sub-menu">
									
									<li class=''>
										<a href="https://docs.pixelfed.org/running-pixelfed/optional-features/livestreaming/">
										  
										  <span>Livestreaming (Pixelfed Live)</span>
										  
										</a>
								  </li>
									
									<li class='active'>
										<a href="https://docs.pixelfed.org/running-pixelfed/optional-features/ldap-authentication/">
										  
										  <span>LDAP Authentication</span>
										  
										</a>
								  </li>
									
									<li class=''>
										<a href="https://docs.pixelfed.org/running-pixelfed/optional-features/websockets/">
										  
										  <span>Websockets</span>
										  
										</a>
								  </li>
									
								</ul>
						  </li>
							
						
				 </ul>
			</li>
				
			
				
				<li class='section-title'>
				 <a href="https://docs.pixelfed.org/developing-pixelfed/">
					
					<span>Developing for Pixelfed</span>
					
				 </a>
				 <ul class="sub-menu">
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/developing-pixelfed/intro/">
								  
								  <span>Setting up your environment</span>
								  
								</a>
						  </li>
							
						
				 </ul>
			</li>
				
			
				
				<li class='section-title'>
				 <a href="https://docs.pixelfed.org/technical-documentation/">
					
					<span>Technical documentation</span>
					
				 </a>
				 <ul class="sub-menu">
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/technical-documentation/activitypub/">
								  
								  <span>ActivityPub</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/technical-documentation/config/">
								  
								  <span>Configuration</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/technical-documentation/artisan/">
								  
								  <span>Laravel Artisan</span>
								  
								</a>
						  </li>
							
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/technical-documentation/api-v1/">
								  
								  <span>v1 API</span>
								  
								</a>
						  </li>
							
						
				 </ul>
			</li>
				
			
				
				<li class='section-title'>
				 <a href="https://docs.pixelfed.org/install-guides/">
					
					<span>Distro-specific install guides</span>
					
				 </a>
				 <ul class="sub-menu">
						
							
							<li class=''>
								<a href="https://docs.pixelfed.org/install-guides/arch/">
								  
								  <span>Arch Linux</span>
								  
								</a>
						  </li>
							
						
				 </ul>
			</li>
				
			
	  </ul>
	</div>
</nav>
		
<main>
	<article class="page">
		<header class="page-header section">
			<div class="container">
				<h1 class="page-title">LDAP Authentication</h1>
				<p class="page-summary">You can configure your Pixelfed server to authenticate with an LDAP Server!</p>
				<p class="lastmod">Last modified <datetime class="date"> Sun Aug 7, 2022 </datetime> - <a href="https://github.com/pixelfed/docs/edit/hugo/content/en/running-pixelfed/optional-features/ldap-authentication.md">Edit this page on Github</a></p>
				

			</div>
		</header>
		<aside class="toc section">
			<div class="container">
				<p class="toc-title">Page outline</p>
			<nav id="TableOfContents">
  <ol>
    <li><a href="#prerequisites">Prerequisites</a>
      <ol>
        <li><a href="#step-1-updating-user-model">Step 1: Updating user model</a></li>
        <li><a href="#step-2-configuring-session-driver">Step 2: Configuring session driver</a></li>
        <li><a href="#step-3-connecting-to-ldap">Step 3: Connecting to LDAP</a></li>
        <li><a href="#step-4-finishing-up">Step 4: Finishing Up!</a></li>
      </ol>
    </li>
  </ol>
</nav>
			</div>
		</aside>
		<section class="content section">
			<div class="container">
				<h2 id="prerequisites">
    <span>Prerequisites</span>
	 <a class="heading-anchor" href="#prerequisites">
		⛓
    </a>
</h2><ul>
<li>
<p>Enable the <code>ext-ldap</code> PHP extension in your servers <code>php.ini</code> configuration</p>
</li>
<li>
<p>Run the following command in Pixelfed root directory (the one with app, bootstrap, public, storage)</p>
</li>
</ul>
<pre tabindex="0"><code>composer require directorytree/ldaprecord-laravel
</code></pre><h3 id="step-1-updating-user-model">
    <span>Step 1: Updating user model</span>
	 <a class="heading-anchor" href="#step-1-updating-user-model">
		⛓
    </a>
</h3><p>You need to edit the <code>app/User.php</code> file and add the first two lines</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">LdapRecord\Laravel\Auth\LdapAuthenticatable</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">LdapRecord\Laravel\Auth\AuthenticatesWithLdap</span>;
</span></span></code></pre></div><p>Then change the following line to include <code>implements LdapAuthenticatable</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Authenticatable</span> <span style="color:#66d9ef">implements</span> <span style="color:#a6e22e">LdapAuthenticatable</span>
</span></span></code></pre></div><p>And finally add <code>AuthenticatesWithLdap</code> after the other traits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Notifiable</span>, <span style="color:#a6e22e">SoftDeletes</span>, <span style="color:#a6e22e">HasApiTokens</span>, <span style="color:#a6e22e">UserRateLimit</span>, <span style="color:#a6e22e">HasFactory</span>, <span style="color:#a6e22e">AuthenticatesWithLdap</span>;
</span></span></code></pre></div><p>Afterwards your <code>app/User.php</code> file should look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> <span style="color:#a6e22e">App</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Laravel\Passport\HasApiTokens</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Notifications\Notifiable</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Database\Eloquent\SoftDeletes</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Foundation\Auth\User</span> <span style="color:#66d9ef">as</span> <span style="color:#a6e22e">Authenticatable</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">App\Util\RateLimit\User</span> <span style="color:#66d9ef">as</span> <span style="color:#a6e22e">UserRateLimit</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Illuminate\Database\Eloquent\Factories\HasFactory</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">LdapRecord\Laravel\Auth\LdapAuthenticatable</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">LdapRecord\Laravel\Auth\AuthenticatesWithLdap</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Authenticatable</span> <span style="color:#66d9ef">implements</span> <span style="color:#a6e22e">LdapAuthenticatable</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Notifiable</span>, <span style="color:#a6e22e">SoftDeletes</span>, <span style="color:#a6e22e">HasApiTokens</span>, <span style="color:#a6e22e">UserRateLimit</span>, <span style="color:#a6e22e">HasFactory</span>, <span style="color:#a6e22e">AuthenticatesWithLdap</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     * The attributes that should be mutated to dates.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     * @var array
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> $dates <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;deleted_at&#39;</span>, <span style="color:#e6db74">&#39;email_verified_at&#39;</span>, <span style="color:#e6db74">&#39;2fa_setup_at&#39;</span>];
</span></span></code></pre></div><h3 id="step-2-configuring-session-driver">
    <span>Step 2: Configuring session driver</span>
	 <a class="heading-anchor" href="#step-2-configuring-session-driver">
		⛓
    </a>
</h3><p>Open the <code>config/auth.php</code> file and comment out or delete the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>    <span style="color:#75715e">// Comment out or remove below for LDAP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;users&#39;</span> <span style="color:#f92672">=&gt;</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;driver&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;eloquent&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;model&#39;</span>  <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">App\User</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>,
</span></span><span style="display:flex;"><span>    ],
</span></span></code></pre></div><p>Insert the following code immediately after the previous lines you commented out or deleted:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#e6db74">&#39;users&#39;</span> <span style="color:#f92672">=&gt;</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;driver&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;ldap&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;model&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">LdapRecord\Models\ActiveDirectory\User</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;rules&#39;</span> <span style="color:#f92672">=&gt;</span> [],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;database&#39;</span> <span style="color:#f92672">=&gt;</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;model&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">App\User</span><span style="color:#f92672">::</span><span style="color:#a6e22e">class</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;sync_passwords&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;sync_attributes&#39;</span> <span style="color:#f92672">=&gt;</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;cn&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;email&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;mail&#39;</span>,
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>],
</span></span></code></pre></div><h3 id="step-3-connecting-to-ldap">
    <span>Step 3: Connecting to LDAP</span>
	 <a class="heading-anchor" href="#step-3-connecting-to-ldap">
		⛓
    </a>
</h3><p>Configure your LDAP server settings.</p>
<p>Add the following lines to your <code>.env</code> file and edit to your needs.</p>
<pre tabindex="0"><code>LDAP_LOGGING=true
LDAP_CONNECTION=default
LDAP_CONNECTIONS=default

LDAP_DEFAULT_HOSTS=10.0.0.1
LDAP_DEFAULT_USERNAME=&#34;cn=admin,dc=local,dc=com&#34;
LDAP_DEFAULT_PASSWORD=secret
LDAP_DEFAULT_PORT=389
LDAP_DEFAULT_BASE_DN=&#34;dc=local,dc=com&#34;
LDAP_DEFAULT_TIMEOUT=5
LDAP_DEFAULT_SSL=false
LDAP_DEFAULT_TLS=false
</code></pre><h3 id="step-4-finishing-up">
    <span>Step 4: Finishing Up!</span>
	 <a class="heading-anchor" href="#step-4-finishing-up">
		⛓
    </a>
</h3><p>You&rsquo;re almost ready! The last thing you need to do is flush the configuration cache by running</p>
<pre tabindex="0"><code>php artisan config:cache
</code></pre><p>You are now ready to login via LDAP!</p>
<p>To test your connection you can run</p>
<pre tabindex="0"><code>php artisan ldap:test
</code></pre>
			</div>
		</section>
		<footer class="section">
			<div class="container">
				<nav class="section-nav">
	
	<a class="previous" href="https://docs.pixelfed.org/running-pixelfed/optional-features/livestreaming/">Previous page:<br/>Livestreaming (Pixelfed Live)</a>
	
	
</nav>
			</div>
		</footer>
	</article>
</main>

		<footer class="site-footer">
	<hr>
	<div class="container">
		
		<a href="#top">back to top</a>
	</div>
</footer>
	</body>
</html>